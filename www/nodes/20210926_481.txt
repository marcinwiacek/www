Title: Produkt ma działać. Lamerstwa ciąg dalszy czy Polska może się technicznie odnaleźć? (2021)
Author:marcin
When:26 Sep 2021
Taxonomy:polski,polski blog,salon24.pl,Hyperbook,x86

<a name=gora></a><hr size="2" noshade="noshade" width="60%" align="center" style="color: rgb(0, 64, 128);"><div align="center"><font size="1">Artykuł został <a href=https://www.salon24.pl/u/techracja/1168662,produkt-ma-dzialac-lamerstwa-ciag-dalszy-czy-polska-moze-sie-technicznie-odnalezc>opublikowany w serwisie salon24.pl</a></font><a name=Top></a></div><hr size="2" noshade="noshade" width="60%" align="center" style="color: rgb(0, 64, 128);">
<p>Misja Inspiration 4 wystartowała, i wróciła. Wielkie gratulacje… i przede wszystkim refleksja, że jedyny dobry produkt to przede wszystkim taki produkt, który działa.</p>
<!--break-->
<p>Jeżeli odnieść to do naszego podwórka, to trzeba wspomnieć niesławnego CyberPunka 2077. Wielki hype, wielkie podkręcanie atmosfery, i legendarne wręcz błędy. <a href="?q=node/431">Próbowałem kiedyś znaleźć przyczyny tego „niepowodzenia” i analizować, czy zawiniła słynna polska ułańska fantazja czy coś innego.</a> Na pewno sprawdziło się tu powiedzenie, że chytry traci dwa razy (firma ciągle wydaje fundusze na poprawki, ilość graczy spada, i nie jest powiedziane, czy kiedykolwiek nawet spojrzą na produkcje CD Projekt). Jest o tyle przykre, że akurat ten producent ma (miał?) zaplecze technologiczne, i mógłby tworzyć cuda i cudeńka… w przeciwieństwie do innych firm, które ledwo zipią, ubijane przez tych, którzy dokładają kolejne plusy i śmieją się w kułak.</p>
<p>Zapytam się ogólnie: czy w tej sytuacji dziejowej nie powinniśmy iść drogą Chińczyków i zamiast rzeczy dużych wrócić do źródła i zaczynać od produkcji drobiazgów? W dziedzinie hardware mamy RISC-V, w dziedzinie software możemy wszystko opierać na Open Source, i jeżeli dajmy na to produkujemy jakiś sterownik czy jakieś małe urządzenie, nie musi często i gęsto mieć x86, tylko może działać np. na malinie.</p>
<p>To nie jest tak, że Polacy są głupi. Owszem, marnota umysłowa wybija tu i tam jak szambo, ale… myślę, że potencjał w narodzie wciąż wielki. A od małych rzeczy można zawsze przejść do dużych. Pamiętajmy, że nie mamy chińskich ograniczeń importowych, i na końcu możemy działać nawet na najpotężniejszym sprzęcie. A ten się zmienia z roku na rok, i już Ryzen na podstawce AM4 daje możliwości, o jakich można było tylko śnić kilka lat temu.</p>
<p>Gdy dzisiaj oglądam „Człowieka z kamienia” czy „Czy człowieka z żelaza”, to charakterystyczne jest to, jak ludzie używali telefonów na sznurku i wielu innych prymitywnych gadżetów. I żeby była jasność: to, co na wideo poniżej to była już kosmiczna nowoczesność:
<center><div class="embed-responsive embed-responsive-16by9"><iframe src="//www.youtube.com/embed/9KmaSsBJBwc" class="note-video-clip"   frameborder="0">
</iframe></div></center>
<p>Wszyscy wtedy myśleli, że nie można mieć innego. Że owszem, trzeba coś zmienić, ale jest to trudne, a może jeszcze niemożliwe… ale nie można się poddawać.</p>
<p>Obecne x86 to dla mnie też raczej przykład rozwiązań, które są raczej u końca swojej ścieżki rozwoju (no chyba, że 12-generacja Intela czy kolejna iteracja AMD coś zmieni, ale to dopiero potwierdzimy co najmniej za rok czy dwa)</p>
<p>Misja Inspiration 4 być może oznacza początek nowej ery, w której wszystko będzie inaczej, trzeba jedynie mieć jedną rzecz na uwadze – tak mocno propagowane wymienianie sprzętu często i gęsto nie jest potrzebne, a zaoszczędzone pieniądze trzeba inwestować w rozwój.</p>
<p>O tym wspominałem i wspomnę znowu – zamiast co roku kupować nowy iPhone, wykorzystaj go tak długo, jak długo wspiera go Apple; jeśli masz Samsunga, po zakończeniu okresu wsparcia spróbuj z czystym Androidem (sam będę chyba eksperymentował z S9), itd. itd.</p>
<p>Trzeba pamiętać o jednym: kupowanie sprzętu nie jest celem samym w sobie, i urządzenia są tylko narzędziem do osiągnięcia określonych celów.</p>
<p><a href="?q=node/480">Można się w tym momencie śmiać z moich prób zabaw z Hyperbookiem (co mi zarzucono pod poprzednim postem)</a>, chcę jednak zauważyć, że od czegoś trzeba zacząć. Na pewno nie chcę spędzić całego życia na próbach modyfikacji oprogramowania po to żeby osiągnąć 60h pracy na baterii w jednym konkretnym modelu… ale warto poznać podstawy, żeby przynajmniej zrozumieć, jak to działa (i do czego można to wykorzystać).</p>
<p>I tak kilka luźnych uwag, które mnie naszły po <a href="?q=node/480">poście „Producent / sprzedawca (obecnie) mówią o 20h na baterii, ja mam nawet prawie 36h”</a>:</p>
<ol>
<li>przeniesienie całego /var/log do RAM (system plików tmpfs) jest jakimś rozwiązaniem, ale wtedy wylewamy dziecko z kąpielą (tracimy dostęp do logów różnych aplikacji, a usługi nadal działają, i co jakiś czas wybudzają CPU, robiąc swoje operacje)</li>
<li>długie czasy pracy na baterii uzyskujemy oczywiście wyłącznie wtedy, gdy nic nie robimy – podczas „normalnego” działania, obciążania CPU i sprzętu można zejść nawet na max. kilka h (najważniejsza jest duża fizycznie bateria, i to w Hyperbooku jest wzorowe; a optymalizacje oczywiście są kluczowe, ale są tylko dodatkiem)</li>
<li>powertop i turbostat pokazują, że cały układ procesora wchodzi maksymalnie w stan energetyczny pc8 (ciężko mi powiedzieć, czy jest to ograniczenie płyty głównej czy zła konfiguracja BIOS, bo jak przypuszczam sam procesor i chipset powinny być do tego zdolne; istnieje też inna możliwość: <a href="https://github.com/system76/firmware-open/blob/master/docs/intel-me.md" target="_blank" rel="nofollow noopener">na stronie od System76 można przeczytać, że wyłączenie Intel ME bitem HAP skutkuje dokładnie brakiem stanów C9, C10 i znaczącym zwiększeniem zużycia energii w trybie S0ix suspend</a>)</li>
<li>dane o trybach energetycznych są pobierane z UEFI / tabel ACPI – używany jest sterownik intel_idle, ale ten dla procesorów 11-generacji nie ma swoich tabel (sprawdziłem w źródłach ostatnich jąder linuksowych), co mnie poniekąd dziwi, bo piszą go inżynierowie od Intela</li>
<li>jest takie narzędzie od Intela s0ix-selftest-tool, i ono pokazuje, że w systemie nie wszystkie elementy wchodzą w najgłębsze stany energetyczne (S0ix suspend nie działa jak mógłby działać).</li>
<li>w kwestii ograniczania procesora – pod Linuxem możliwe jest ustawienie limitów energetycznych (TDP), schedulera dla prędkości (który decyduje, jak mocno przyspieszyć rdzenie), włączenie / wyłączenie turbo, i oczywiście ustawienie maksymalnej prędkości rdzeni albo tego, jak mocno chcemy oszczędzać energię (wartość 15 ustawia maksymalne oszczędzanie w EPB, a 2400000 to 2,4Ghz):<br />
<pre>sudo cpupower set -b 15
sudo cpupower frequency-set -u 2400000</pre></li>
<li>w kwestii prędkości karty graficznej Intela – można zablokować jej prędkość, np. poniżej ustawiam 100Mhz:<br />
<pre>sudo intel_gpu_frequency -s 100</pre></li>
<li>w opcjach jądrach (GRUB_CMDLINE_LINUX w /etc/default/grub, potem update-grub) można wymusić włączenie ASPM:<br />
<pre>pcie_aspm=force pcie_aspm.policy=powersupersave</pre></li>
<li>dalej nie wiem, jak sprawdzić statystyki dysku (ile trwa w którym stanie energetycznym)</li>
</ol>
<p>Prawdopodobnie w tym momencie doszedłem już z tym sprzętem do ściany - z tego, co znalazłem, tryby pc9 i pc10 oznaczają mniej więcej ograniczenie napięcia vcc i fizyczne odcinanie procesora od prądu (a płyty głównej czy UEFI chyba nie zmienię). Są to już tematy głównie omawiane przez inżynierów, którzy projektują sprzęt, albo piszą oprogramowanie niskopoziomowe do jego konfiguracji.</p>
<p>Dla mnie ciekawe jest to, jak x86 zaszło daleko przez lata, i jak jest tam dużo być może niepotrzebnego skomplikowania, i wreszcie to, jak dużo ciekawych rzeczy można odkryć pracując z darmowym oprogramowaniem. Teoretycznie mógłbym jeszcze oczywiście pobawić się w kompilację jądra i wszystkich aplikacji, wyrzucenie wszystkiego z cron, zmianę gnome na coś lżejszego, sprawdzenie ClearLinux (to taka dystrybucja od Intela, która według Phoronix osiąga lepsze wyniki niż Ubuntu), i inne tego typu rzeczy, niemniej jednak na tę chwilę to chyba nie ma głębszego sensu – nawet dosyć standardowe Ubuntu wydaje się w większości wyciskać ostatnie soki z użytego laptopa (a w każdym razie można użyć kilku przełączników, i często widzieć obrazki jak poniżej)<br />
<center><img src="sites/default/files/481/1.png" style="width: 281.3px; height: 263.345px;" alt="image" /></center>
Nowoczesny „computing” polega na tym, że praktycznie wszystkiego ma być mniej – mniej zużycia prądu (tymczasem teoretycznie schodzimy coraz bardziej z wielkością układów, a te dalej brzydko mówiąc żrą swoje), mniej zajętego miejsca i hałasu, mniej urządzeń (będziemy je wyłączać, gdy nie są potrzebne, dodatkowo integrować), wreszcie mniej aplikacji i przesyłanych danych (stąd chociażby popularne blockery do reklam w przeglądarkach).</p>
<p>Ten, kto tego nie zauważy, stoi na przegranej pozycji. Za kilka lat może się okazać, że to, co teraz jest najlepsze, wtedy będzie się nadawało do umieszczenia w skansenie. Możliwe, że wtedy pójdę sobie do sklepu i kupię taki komputer, który będzie działał na baterii 100h… ale to będzie za kilka lat, a obecnie mam sprzęt, który spokojnie powinien zarobić na siebie (dając mi możliwość wykonywania pracy czy rozrywki).</p>
<p>A tak w ogóle, to czasy garażowych wynalazców może i częściowo minęły, ale… nie zmienia to faktu, że jak ktoś chce, to może (bo dobrej baletnicy nie przeszkadza rąbek u spódnicy):
<center><p><div class="embed-responsive embed-responsive-16by9"><iframe src="//www.youtube.com/embed/uqY3FMuMuRo" class="note-video-clip"   frameborder="0">
</iframe></div>
<div class="embed-responsive embed-responsive-16by9"><iframe src="//www.youtube.com/embed/IS5ycm7VfXg" class="note-video-clip"   frameborder="0">
</iframe></div></center>
<p>Ja może nie doszedłem do tego poziomu, ale nie oznacza to, że nie będę próbował i nie będę pisał różnych artykułów. Bo cała zabawa polega na tym, żeby stawiać sobie coraz bardziej ambitne cele i wyzwania, i je realizować. Tak działa świat (a przynajmniej tak działa ten normalny świat, w którym dyletanci nie mają głosu przywódczego). Nie interesuje go polskie piekiełko i to, że jedni Polacy często i gęsto najchętniej utopiliby innych w łyżce wody (zaczyna się od wyzywania od lamerów, a potrafi kończyć na czymś więcej). Tam liczą się rezultaty (co ważne – nie mówię o tym świecie, w którym np. to przynależność do jakiejś grupy, a nie kwalifikacje, decydują o przyjęciu do pracy).</p>
<p>Tylko tyle, i aż tyle.</p>
